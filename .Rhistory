for ( j in 1: nboot){
tmp <- ListBootSurv[[j]]$d
tmp2 <-  as.character(tmp[,1])
allpairspt <- c(allpairspt, tmp2)
}
allpairsptu <- unique(allpairspt)
nboot=2
allpairspt<-NULL
for ( j in 1: nboot){
tmp <- ListBootSurv[[j]]$d
tmp2 <-  as.character(tmp[,1])
allpairspt <- c(allpairspt, tmp2)
}
allpairsptu <- unique(allpairspt)
library(edgeR)
source('C:/Users/663676/Desktop/prostate_cancer/Functions_for_pathways_classification.R')
load("C:/Users/663676/Desktop/prostate_cancer/dati_mRNA_miRNA.RData")
ListBootSurv <- list()
#nfs <- 60 #NumberoFsample_training
#nboot<-50
startboot<-1
stopboot<-7
for ( k in startboot:stopboot){
print(k)
if(length(colnames(Data_CANCER_miRNA_tumor_HighStage_filtered)) > length(colnames(Data_CANCER_miRNA_normal_filtered))){
tumor_sample <- sample(colnames(Data_CANCER_miRNA_tumor_HighStage_filtered), length(colnames(Data_CANCER_miRNA_normal_filtered)))
}
Data_CANCER_miRNA_tumor_HighStage_filtered<-Data_CANCER_miRNA_tumor_HighStage_filtered[,tumor_sample]
CANCER_diff_normUQ_miRNA <- DEA_edge5(Data_CANCER_miRNA_normal_filtered,Data_CANCER_miRNA_tumor_HighStage_filtered, "Normal", "Tumor")
CANCER_diff_normUQ_level_miRNA <- CreateTabLevel( as.matrix(rownames(CANCER_diff_normUQ_miRNA)),CANCER_diff_normUQ_miRNA,"Tumor","Normal",Data_CANCER_miRNA_tumor_HighStage_filtered,Data_CANCER_miRNA_normal_filtered,typeOrder=T)
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_miRNA[abs(CANCER_diff_normUQ_level_miRNA$logFC) >= 1,]
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_filtered_miRNA[CANCER_diff_normUQ_level_filtered_miRNA$FDR < 0.01,]
#save(CANCER_diff_normUQ_level_miRNA,CANCER_diff_normUQ_level_filtered_miRNA, file = "STEP1_miRNA_DEA.Rdata")
ListBootSurv[[length(ListBootSurv)+1]] <- list(label=paste("boot",k,sep=""),c=CANCER_diff_normUQ_level_miRNA,d=CANCER_diff_normUQ_level_filtered_miRNA )
#save(ListBootSurv , file ="../DataResult/miRNA_ListBootSurv_50boot_lumA_samples.RData")
save(ListBootSurv , file ="C:/Users/663676/Desktop/prostate_cancer/mRNA_ListBootSurv_boot_1_7_prad_samples.RData")
save(k, file = paste(k,".RData",sep=""))
}
load("C:/Users/663676/Desktop/prostate_cancer/mRNA_ListBootSurv_boot_1_7_prad_samples.RData")  # cambiare TUTTO CON I Risultati con i dati ILLUMINA A
nboot=7
allpairspt<-NULL
for ( j in 1: nboot){
tmp <- ListBootSurv[[j]]$d
tmp2 <-  as.character(tmp[,1])
allpairspt <- c(allpairspt, tmp2)
}
allpairsptu <- unique(allpairspt)
allpairspt
allpairsptu
tmp <- ListBootSurv[[1]]$d
tmp2 <-  as.character(tmp[,1])
View(tmp)
tmp[,1]
allpairspt <- c(allpairspt, tmp2)
allpairspt
load("C:/Users/663676/Desktop/PathwayClassification/DataResultSTEP18_miRNA_masterRegulator_Fishercomplete")
load("C:/Users/663676/Desktop/PathwayClassification/DataResultSTEP18_miRNA_masterRegulator_Fishercomplete.R")
load("C:/Users/663676/Desktop/PathwayClassification/DataResultSTEP18_miRNA_masterRegulator_Fishercomplete.RData")
load("C:/Users/663676/Desktop/PathwayClassification/DataResult/STEP18_miRNA_masterRegulator_Fishercomplete.RData")
Table_Fisher_TF_complete
View(Table_Fisher_TF_complete)
source("http://bioconductor.org/biocLite.R")
biocLite("DEGseq")
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
View(card)
id<-card[1,]
View(id)
id<-card[,1]
rownames(card)<-id
View(card)
NULL<-card[,1]
card[,1]<-NULL
View(card)
View(card)
disease<-card[1:106,]
View(disease)
colnames(disease)
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
card[,1]<-NULL
disease<-card[,1:106]
rownames(disease)
colnames(disease)
normal<-card[,107:142]
colnames(normal)
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
card[,1]<-NULL
disease<-card[,1:106]
normal<-card[,107:142]
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
card[,1]<-NULL
card <- t (card)
card<- cbind(event = rownames(card),card)
View(card)
rownames(card)
disease<-card[1:106,]
normal<-card[107:144,]
View(disease)
disease
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
disease<-card[,1:106]
normal<-card[,107:144]
quantile_thresh_miR<- 0.25
Mean_tumor_miR<-rowMeans(disease)
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
disease<-card[,1:106]
normal<-card[,107:144]
quantile_thresh_miR<- 0.25
#Mean_tumor_mRNA<-rowMeans(Table_Cancer_mRNA_stageC)
Mean_tumor_miR<-rowMeans(disease)
View(disease)
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
card[,1]<-NULL
disease<-card[,1:106]
normal<-card[,107:144]
quantile_thresh_miR<- 0.25
#Mean_tumor_mRNA<-rowMeans(Table_Cancer_mRNA_stageC)
Mean_tumor_miR<-rowMeans(disease)
Mean_tumor_miR
Mean_tumor_miR_ordered<-sort(Mean_tumor_miR)
Quantile_tumor_miR<-quantile(Mean_tumor_miR,quantile_thresh_miR)
card<-read.delim("C:/Users/663676/Desktop/CARDIOPATIE/GSE36961_R.txt")
id<-card[,1]
rownames(card)<-id
card[,1]<-NULL
#card<- cbind(event = rownames(card),card)
disease<-card[,1:106]
normal<-card[,107:144]
quantile_thresh_miR<- 0.25
#Mean_tumor_mRNA<-rowMeans(Table_Cancer_mRNA_stageC)
Mean_tumor_miR<-rowMeans(disease)
Mean_tumor_miR_ordered<-sort(Mean_tumor_miR)
#Quantile_tumor_mRNA<-quantile(Mean_tumor_mRNA,quantile_thresh_mRNA)
Quantile_tumor_miR<-quantile(Mean_tumor_miR,quantile_thresh_miR)
Mean_tumor_miR
ProjectFolder <- "C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast"
setwd(ProjectFolder)
load("BRCA_fromTCGA.RData")
counts <- load(file.choose())
View(Data_CANCER_normUQ_filt)
load(file.choose())
View(Data_CANCER_normUQ_filt)
tcga_brca_classification_rnaseq <- read.table(file.choose())
tcga_brca_classification_rnaseq <- read.table(file.choose())
tcga_brca_classification_rnaseq <- read.delim(file.choose())
tcga_brca_classification_rnaseq_selected <- tcga_brca_classification_rnaseq[tcga_brca_classification_rnaseq$PAM50.subtype.from.RNAseq.data..TCGA.AWG. == "LumA",]
tcga_selected_positive <- tcga_brca_classification_rnaseq_selected[tcga_brca_classification_rnaseq_selected$breast.carcinoma.estrogen.receptor.status =="Positive",]
tcga_selected_positive <- tcga_brca_classification_rnaseq_selected[tcga_brca_classification_rnaseq_selected$breast.carcinoma.estrogen.receptor.status =="Negative",]
tcga_selected_positive <- tcga_brca_classification_rnaseq_selected[tcga_brca_classification_rnaseq_selected$breast.carcinoma.estrogen.receptor.status =="Positive",]
load("STEP1_Data.Rdata")
load(file.choose())
View(Data_CANCER_normUQ_filt_normal)
View(Data_CANCER_normUQ_filt_tumor)
View(Data_CANCER_miRNA)
View(Data_CANCER_miRNA)
colnames(Data_CANCER_miRNA_tumor) <- substr(colnames(Data_CANCER_miRNA_tumor), 1, 15)
Data_CANCER_miRNA_tumor <- Data_CANCER_miRNA_tumor[,unique(colnames(Data_CANCER_miRNA_tumor))]  #1046  720
load("STEP1a_ClinicalData.RData")
load(file.choose())
load(file.choose())
load(file.choose())
rownames(Data_CANCER_miRNA)<-Des
#Functions_for_pathways_classification
load(file.choose())
source('C:/Users/663676/Desktop/pathway_therapy\TCGA_Data_Breast/Functions_for_pathways_classification.R')
source('C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/Functions_for_pathways_classification.R')
Data_CANCER_miRNA_normal <- SelectedSample(Data_CANCER_miRNA,"normal")
Data_CANCER_miRNA_tumor <- SelectedSample(Data_CANCER_miRNA,"tumor")
TumorSamplemiR <- ncol(Data_CANCER_miRNA_tumor)
NormalSamplemiR <- ncol(Data_CANCER_miRNA_normal)
Sample_miR_Tumor <- substr(colnames(Data_CANCER_miRNA_tumor), 1, 16)
Sample_mRNA_Tumor  <- colnames(Data_CANCER_normUQ_filt_tumor)
Sample_Tumor_matched_miR_mRNA<-intersect(Sample_miR_Tumor,Sample_mRNA_Tumor)
save(Data_CANCER_normUQ_filt_normal, Data_CANCER_normUQ_filt_tumor, numberofmRNA, TumorSamplemiR, NormalSamplemiR, Data_CANCER_miRNA, numberofmiRNA, TumorSamplemRNA,NormalSamplemRNA,Data_CANCER_miRNA_normal ,Data_CANCER_miRNA_tumor, file = "STEP1_Data.Rdata")
save(Data_CANCER_miRNA_normal ,Data_CANCER_miRNA_tumor, file = "STEP1_Data.Rdata")
load(file.choose())
tcga_brca_classification_rnaseq <- read.delim(file.choose())
tcga_brca_classification_rnaseq_selected <- tcga_brca_classification_rnaseq[tcga_brca_classification_rnaseq$PAM50.subtype.from.RNAseq.data..TCGA.AWG. == "LumA",]
tcga_selected_positive <- tcga_brca_classification_rnaseq_selected[tcga_brca_classification_rnaseq_selected$breast.carcinoma.estrogen.receptor.status =="Positive",]
load(file.choose())
load(file.choose())
load(file.choose())
Data_CANCER_miRNA_normal <- SelectedSample(Data_CANCER_miRNA,"normal")
source('C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/Functions_for_pathways_classification.R')
Data_CANCER_miRNA_normal <- SelectedSample(Data_CANCER_miRNA,"normal")
Data_CANCER_miRNA_tumor <- SelectedSample(Data_CANCER_miRNA,"tumor")
length(Data_CANCER_miRNA_tumor)
nrow(Data_CANCER_miRNA_tumor)
ncol(Data_CANCER_miRNA_tumor)
Data_CANCER_miRNA_tumor <- Data_CANCER_miRNA_tumor[,unique(colnames(Data_CANCER_miRNA_tumor))]  #1046  720
Data_CANCER_normUQ_filt_tumor <- Data_CANCER_normUQ_filt_tumor[,unique(colnames(Data_CANCER_normUQ_filt_tumor))] #15243  1052
colnames(Data_CANCER_miRNA_tumor) <- substr(colnames(Data_CANCER_miRNA_tumor), 1, 15)
colnames(Data_CANCER_normUQ_filt_tumor) <- substr(colnames(Data_CANCER_normUQ_filt_tumor), 1, 15)
commonSamples_mirna_genes <- intersect(colnames(Data_CANCER_miRNA_tumor), substr(colnames(Data_CANCER_normUQ_filt_tumor),1,15)) # 702 samples common mirna and genes
commonSampleSelected <- intersect(commonSamples_mirna_genes, tcga_selected_positive$X_SAMPLE_ID) # we selected 233 common with mirna sample and selected samples
load(file.choose())
tcga_brca_classification_rnaseq <- read.delim(file.choose())
tcga_brca_classification_rnaseq_selected <- tcga_brca_classification_rnaseq[tcga_brca_classification_rnaseq$PAM50.subtype.from.RNAseq.data..TCGA.AWG. == "LumA",]
tcga_selected_positive <- tcga_brca_classification_rnaseq_selected[tcga_brca_classification_rnaseq_selected$breast.carcinoma.estrogen.receptor.status =="Positive",]
commonSamples_mirna_genes <- intersect(colnames(Data_CANCER_miRNA_tumor), substr(colnames(Data_CANCER_normUQ_filt_tumor),1,15)) # 702 samples common mirna and genes
commonSampleSelected <- intersect(commonSamples_mirna_genes, tcga_selected_positive$X_SAMPLE_ID) # we selected 233 common with mirna sample and selected samples
Data_CANCER_miRNA_tumor_HighStage <- Data_CANCER_miRNA_tumor[,commonSampleSelected ]
Data_CANCER_mRNA_tumor_HighStage <-  Data_CANCER_normUQ_filt_tumor[,commonSampleSelected]
quantile_thresh_mRNA<- 0.25
quantile_thresh_miR<- 0.25
#Mean_tumor_mRNA<-rowMeans(Table_Cancer_mRNA_stageC)
Mean_tumor_miR<-rowMeans(Data_CANCER_miRNA_tumor_HighStage)
Mean_tumor_miR_ordered<-sort(Mean_tumor_miR)
#Quantile_tumor_mRNA<-quantile(Mean_tumor_mRNA,quantile_thresh_mRNA)
Quantile_tumor_miR<-quantile(Mean_tumor_miR,quantile_thresh_miR)
#Table_Cancer_mRNA_stageC_filtered<-Table_Cancer_mRNA_stageC[  t(rowMeans(Table_Cancer_mRNA_stageC))  > Quantile_tumor_mRNA,  ]
Data_CANCER_miRNA_tumor_HighStage_filtered<-Data_CANCER_miRNA_tumor_HighStage[  t(rowMeans(Data_CANCER_miRNA_tumor_HighStage))  > Quantile_tumor_miR,  ]
Data_CANCER_miRNA_normal_filtered <- Data_CANCER_miRNA_normal[  rownames(Data_CANCER_miRNA_tumor_HighStage_filtered), ]
library(edgeR)
CANCER_diff_normUQ_miRNA <- DEA_edge5(Data_CANCER_miRNA_normal_filtered,Data_CANCER_miRNA_tumor_HighStage_filtered, "Normal", "Tumor")
CANCER_diff_normUQ_level_miRNA <- CreateTabLevel( as.matrix(rownames(CANCER_diff_normUQ_miRNA)),CANCER_diff_normUQ_miRNA,"Tumor","Normal",Data_CANCER_miRNA_tumor_HighStage_filtered,Data_CANCER_miRNA_normal_filtered,typeOrder=T)
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_miRNA[abs(CANCER_diff_normUQ_level_miRNA$logFC) >= FC_thresh_mRNA,]
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_filtered_miRNA[CANCER_diff_normUQ_level_filtered_miRNA$FDR < FDR_thresh_mRNA,]
Mean_tumor_miR_ordered<-sort(Mean_tumor_miR)
#Quantile_tumor_mRNA<-quantile(Mean_tumor_mRNA,quantile_thresh_mRNA)
Quantile_tumor_miR<-quantile(Mean_tumor_miR,quantile_thresh_miR)
#Table_Cancer_mRNA_stageC_filtered<-Table_Cancer_mRNA_stageC[  t(rowMeans(Table_Cancer_mRNA_stageC))  > Quantile_tumor_mRNA,  ]
Data_CANCER_miRNA_tumor_HighStage_filtered<-Data_CANCER_miRNA_tumor_HighStage[  t(rowMeans(Data_CANCER_miRNA_tumor_HighStage))  > Quantile_tumor_miR,  ]
Data_CANCER_miRNA_normal_filtered <- Data_CANCER_miRNA_normal[  rownames(Data_CANCER_miRNA_tumor_HighStage_filtered), ]
library(edgeR)
CANCER_diff_normUQ_miRNA <- DEA_edge5(Data_CANCER_miRNA_normal_filtered,Data_CANCER_miRNA_tumor_HighStage_filtered, "Normal", "Tumor")
CANCER_diff_normUQ_level_miRNA <- CreateTabLevel( as.matrix(rownames(CANCER_diff_normUQ_miRNA)),CANCER_diff_normUQ_miRNA,"Tumor","Normal",Data_CANCER_miRNA_tumor_HighStage_filtered,Data_CANCER_miRNA_normal_filtered,typeOrder=T)
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_miRNA[abs(CANCER_diff_normUQ_level_miRNA$logFC) >= FC_thresh_mRNA,]
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_filtered_miRNA[CANCER_diff_normUQ_level_filtered_miRNA$FDR < FDR_thresh_mRNA,]
FDR_thresh_mRNA <- 0.01
FC_thresh_mRNA <- 1
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_miRNA[abs(CANCER_diff_normUQ_level_miRNA$logFC) >= FC_thresh_mRNA,]
CANCER_diff_normUQ_level_filtered_miRNA <- CANCER_diff_normUQ_level_filtered_miRNA[CANCER_diff_normUQ_level_filtered_miRNA$FDR < FDR_thresh_mRNA,]
View(CANCER_diff_normUQ_level_filtered_miRNA)
nrow(Data_CANCER_mRNA_tumor_HighStage)
ncol(Data_CANCER_mRNA_tumor_HighStage)
ncol(Data_CANCER_normUQ_filt_normal)
CANCER_diff_normUQ_mRNA <- DEA_edge5(Data_CANCER_normUQ_filt_normal,Data_CANCER_mRNA_tumor_HighStage, "Normal", "Tumor")
CANCER_diff_normUQ_level_mRNA <- CreateTabLevel( as.matrix(rownames(CANCER_diff_normUQ_mRNA)),CANCER_diff_normUQ_mRNA,"Tumor","Normal",Data_CANCER_mRNA_tumor_HighStage,Data_CANCER_normUQ_filt_normal,typeOrder=T)
CANCER_diff_normUQ_level_filtered_mRNA <- CANCER_diff_normUQ_level_mRNA[abs(CANCER_diff_normUQ_level_mRNA$logFC) >= 1,]
CANCER_diff_normUQ_level_filtered_mRNA <- CANCER_diff_normUQ_level_filtered_mRNA[CANCER_diff_normUQ_level_filtered_miRNA$FDR < FDR_thresh_mRNA,]
CANCER_diff_normUQ_level_filtered_mRNA
view(CANCER_diff_normUQ_level_filtered_mRNA)
View(CANCER_diff_normUQ_level_filtered_mRNA)
save(CANCER_diff_normUQ_level_mRNA,CANCER_diff_normUQ_level_filtered_mRNA, file = "C:/Users/663676/Desktop/pathway_therapy/risultati/STEP_comparison_DEA_lumA.Rdata")
load(file.choose())
View(EnrichmentAnalysis)
View(EnrichmentAnalysis)
View(EnrichmentAnalysis)
listIPA_pathways <- read.csv("C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/pathways_from_IPA.csv", sep=";", dec=",", stringsAsFactors = F)
IPAGenes <- read.delim("C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/IPA_genes_dataset_summary.txt")
IPAGenes<-IPAGenes[!duplicated(IPAGenes[,"ID"]),]
rownames(IPAGenes) <- IPAGenes[,"ID"]
current_pathway_from_IPA<-listIPA_pathways["Ingenuity.Canonical.Pathways"] # genes from IPA pathways
Genelist<-rownames(CANCER_diff_normUQ_level_filtered_mRNA)
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
load(file.choose())
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
load(file.choose())
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
load(file.choose())
listIPA_pathways <- read.csv("C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/pathways_from_IPA.csv", sep=";", dec=",", stringsAsFactors = F)
IPAGenes <- read.delim("C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/IPA_genes_dataset_summary.txt")
IPAGenes<-IPAGenes[!duplicated(IPAGenes[,"ID"]),]
rownames(IPAGenes) <- IPAGenes[,"ID"]
current_pathway_from_IPA<-listIPA_pathways["Ingenuity.Canonical.Pathways"] # genes from IPA pathways
Genelist<-rownames(CANCER_diff_normUQ_level_filtered_mRNA)
load(file.choose())
load(file.choose())
source('C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/Functions_for_pathways_classification.R')
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
load("EnrichmentAnalyis.RData")
load("EnrichmentAnalyis.R")
load(file.choose())
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
load(file.choose())
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
load(file.choose())
source('C:/Users/663676/Desktop/pathway_therapy/TCGA_Data_Breast/Functions_for_pathways_classification.R')
TimeUse(ans <- EAcomplete(TFname="BRCA DEA genes Luminal A and Normal ",Genelist))
names(ans)
head(ans)
ans$ResPat  # list of pathways enriched by DEA genes between Normal and tumor samples
ans$ResPat  # list of pathways enriched by DEA genes between Normal and tumor samples
Pathways_signif <- t(ans$ResPat)
Pathways_signif <- Pathways_signif [-grep("NA;",Pathways_signif), ]
Pathways_signif <- as.matrix(Pathways_signif)
Cancer_EAcomplete <- ans
Cancer_EAcomplete
Pathways_signif
save(Cancer_EAcomplete,Pathways_signif, listIPA_pathways,file = "C:/Users/663676/Desktop/pathway_therapy/risultati/PEA_lumA.Rdata")
Pathways_signif_names<-Pathways_signif
for( i in 1: nrow(Pathways_signif_names)){
Pathways_signif_names[i] <- as.matrix(unlist(strsplit(Pathways_signif[i], ";")))[1]
}
DataMatrix <- cbind(Data_CANCER_normUQ_filt_normal, Data_CANCER_mRNA_tumor_HighStage)
PEAmatrix <- matrix( 0, nrow(Pathways_signif),ncol(DataMatrix))
rownames(PEAmatrix) <- Pathways_signif_names[,1]
colnames(PEAmatrix) <-  colnames(DataMatrix)
load(file.choose())
tcga_brca_classification_rnaseq <- read.delim(file.choose())
tcga_brca_classification_rnaseq_selected <- tcga_brca_classification_rnaseq[tcga_brca_classification_rnaseq$PAM50.subtype.from.RNAseq.data..TCGA.AWG. == "LumA",]
#looking for lumA ER+
tcga_selected_positive <- tcga_brca_classification_rnaseq_selected[tcga_brca_classification_rnaseq_selected$breast.carcinoma.estrogen.receptor.status =="Positive",]
load(file.choose())
DataMatrix <- cbind(Data_CANCER_normUQ_filt_normal, Data_CANCER_mRNA_tumor_HighStage)
load(file.choose())
DataMatrix <- cbind(Data_CANCER_normUQ_filt_normal, Data_CANCER_mRNA_tumor_HighStage)
Data_CANCER_miRNA_normal <- SelectedSample(Data_CANCER_miRNA,"normal")
Data_CANCER_miRNA_tumor <- SelectedSample(Data_CANCER_miRNA,"tumor")
Data_CANCER_miRNA_tumor <- Data_CANCER_miRNA_tumor[,unique(colnames(Data_CANCER_miRNA_tumor))]  #1046  720
DataMatrix <- cbind(Data_CANCER_normUQ_filt_normal, Data_CANCER_mRNA_tumor_HighStage)
Data_CANCER_miRNA_normal <- SelectedSample(Data_CANCER_miRNA,"normal")
Data_CANCER_miRNA_tumor <- SelectedSample(Data_CANCER_miRNA,"tumor")
Data_CANCER_miRNA_tumor <- Data_CANCER_miRNA_tumor[,unique(colnames(Data_CANCER_miRNA_tumor))]  #1046  720
Data_CANCER_normUQ_filt_tumor <- Data_CANCER_normUQ_filt_tumor[,unique(colnames(Data_CANCER_normUQ_filt_tumor))] #15243  1052
#colnames same for miRNA data e mRNA data
colnames(Data_CANCER_miRNA_tumor) <- substr(colnames(Data_CANCER_miRNA_tumor), 1, 15)
colnames(Data_CANCER_normUQ_filt_tumor) <- substr(colnames(Data_CANCER_normUQ_filt_tumor), 1, 15)
commonSamples_mirna_genes <- intersect(colnames(Data_CANCER_miRNA_tumor), substr(colnames(Data_CANCER_normUQ_filt_tumor),1,15)) # 702 samples common mirna and genes
commonSampleSelected <- intersect(commonSamples_mirna_genes, tcga_selected_positive$X_SAMPLE_ID) # we selected 233 common with mirna sample and selected samples
Data_CANCER_miRNA_tumor_HighStage <- Data_CANCER_miRNA_tumor[,commonSampleSelected ]
Data_CANCER_mRNA_tumor_HighStage <-  Data_CANCER_normUQ_filt_tumor[,commonSampleSelected]
nrow(Data_CANCER_mRNA_tumor_HighStage)
ncol(Data_CANCER_mRNA_tumor_HighStage)
DataMatrix <- cbind(Data_CANCER_normUQ_filt_normal, Data_CANCER_mRNA_tumor_HighStage)
PEAmatrix <- matrix( 0, nrow(Pathways_signif),ncol(DataMatrix))
rownames(PEAmatrix) <- Pathways_signif_names[,1]
colnames(PEAmatrix) <-  colnames(DataMatrix)
View(PEAmatrix)
for ( k in 1: nrow(PEAmatrix)){
currentPathway <- rownames(PEAmatrix)[k]
print(paste("pathway n.", k, "of ", nrow(PEAmatrix),currentPathway, " done." ))
currentPathway_genes <-  as.character(listIPA_pathways [ listIPA_pathways[,"Ingenuity.Canonical.Pathways"] == currentPathway,"Molecules"])
currentPathway_genes_list <-  as.character(as.matrix(unlist(strsplit(currentPathway_genes, ","))))
currentPathway_genes_list_common <- intersect( rownames(DataMatrix), currentPathway_genes_list)
currentPathway_genes_list_commonMatrix <- DataMatrix[currentPathway_genes_list_common,]
}
currentPathway <- rownames(PEAmatrix)[1]
currentPathway
k=1
currentPathway <- rownames(PEAmatrix)[k]
print(paste("pathway n.", k, "of ", nrow(PEAmatrix),currentPathway, " done." ))
currentPathway_genes <-  as.character(listIPA_pathways [ listIPA_pathways[,"Ingenuity.Canonical.Pathways"] == currentPathway,"Molecules"])
listIPA_pathways
View(listIPA_pathways)
listIPA_pathways[,"Ingenuity.Canonical.Pathways"] == currentPathway,"Molecules"
listIPA_pathways [ listIPA_pathways[,"Ingenuity.Canonical.Pathways"] == currentPathway,"Molecules"]
Ingenuity.Canonical.Pathways
currentPathway_genes <-  as.character(listIPA_pathways [ listIPA_pathways[,"Ingenuity.Canonical.Pathways"] == currentPathway,"Molecules"])
currentPathway_genes <-  as.character(listIPA_pathways [ listIPA_pathways[,"Pathway"] == currentPathway,"Molecules"])
currentPathway_genes
currentPathway
listIPA_pathways$Pathway=='Agranulocyte Adhesion and Diapedesis'
currentPathway_genes_list <-  as.character(as.matrix(unlist(strsplit(currentPathway_genes, ","))))
CANCER_diff_normUQ_level_filtered_mRNA$mRNA
currentPathway_genes_list_common <- intersect( CANCER_diff_normUQ_level_filtered_mRNA$mRNA, currentPathway_genes_list)
currentPathway_genes_list_common
View(CANCER_diff_normUQ_level_mRNA)
library(Biobase)
library(GEOquery)
library(limma)
gset <- getGEO("GSE59421", GSEMatrix =TRUE)
g <- make_ring(10)
library(igraph)
g <- make_ring(10)
g
View(g)
g$layout <- layout_in_circle
plot(g)
tkplot(g)
rglplot(g)
plot(g)
g <- make_ring(10)
g$layout <- layout_in_circle
plot(g)
tkplot(g)
g <- barabasi.game(100)
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
plot(g, layout=layout_with_fr, vertex.size=4,
vertex.label.dist=0.5, vertex.color="red", edge.arrow.size=0.5)
g <- sample_gnp(100, 1/100)
comps <- components(g)$membership
colbar <- rainbow(max(comps)+1)
V(g)$color <- colbar[comps+1]
plot(g, layout=layout_with_fr, vertex.size=5, vertex.label=NA)
rglplot(g)
tkplot(g)
g <- make_full_graph(5) %du% make_full_graph(5) %du% make_full_graph(5)
g <- add_edges(g, c(1,6, 1,11, 6,11))
com <- cluster_spinglass(g, spins=5)
V(g)$color <- com$membership+1
g <- set_graph_attr(g, "layout", layout_with_kk(g))
plot(g, vertex.label.dist=1.5)
tkplot(g)
igraph_options(plot.layout=layout_as_tree)
plot(g,vertex.shape="rectangle", vertex.label.dist=1.5)
tkplot(g)
vs <- data.frame(onset=0, terminus=50, vertex.id=1:17)
es <- data.frame(onset=1:49, terminus=50,
head=as.matrix(net3, matrix.type="edgelist")[,1],
tail=as.matrix(net3, matrix.type="edgelist")[,2])
render.d3movie(short.stergm.sim,displaylabels=TRUE)
library(animation)
install.packages("animation")
library(igraph)
1<- layout.fruchterman.reingold(net)
install.packages("ndtv", dependencies=T)
library(Rtools)
install.packages("Rtools")
install.Rtools(choose_version = FALSE, check = TRUE, GUI = TRUE,
page_with_download_url = "http://cran.r-project.org/bin/windows/Rtools/")
install.Rtools()
library(SpidermiR)
org<-SpidermiRquery_species(species)
net_type<-SpidermiRquery_networks_type(organismID=org[9,])
net_shar_prot<-SpidermiRquery_spec_networks(organismID = org[9,],
network = "SHpd")
disease<-SpidermiRquery_disease(diseaseID)
disease
out_net<-SpidermiRdownload_net(net_shar_prot)
library(TCGAbiolinks)
tumour<-c("TCGA-BH-A0DL-01A-11R-A115-07","TCGA-AO-A03P-01A-11R-A00Z-07")
normal<-c("TCGA-BH-A209-11A-42R-A157-07","TCGA-E9-A1N4-11A-33R-A14M-07")
dataType <- "normalized_results"
query <- GDCquery(project = cancer,
data.category = "Gene expression",
data.type = "miRNA gene quantification",
platform = PlatformCancer,
file.type  = dataType,
barcode = c(tumour,normal),
legacy = TRUE)
query <- GDCquery(project = cancer,
data.category = "Gene expression",
data.type = "miRNA gene quantification",
platform = PlatformCancer,
file.type  = dataType,
barcode = c(tumour,normal),
legacy = TRUE)
cancer <- "TCGA-BRCA"
query <- GDCquery(project = cancer,
data.category = "Gene expression",
data.type = "miRNA gene quantification",
platform = PlatformCancer,
file.type  = dataType,
barcode = c(tumour,normal),
legacy = TRUE)
library(jsonlite)
library(downloader)
library(httr)
f <- "https://gdc-api.nci.nih.gov/files/?pretty=true&expand=cases.samples.portions.analytes.aliquots,cases.project,center,analysis&size=360&filters=%7B%22op%22:%22and%22,%22content%22:[%7B%22op%22:%22in%22,%22content%22:%7B%22field%22:%22cases.project.project_id%22,%22value%22:[%22TCGA-ACC%22]%7D%7D,%7B%22op%22:%22in%22,%22content%22:%7B%22field%22:%22files.data_category%22,%22value%22:[%22Copy%20Number%20Variation%22]%7D%7D]%7D"
# this should give an error
json <- fromJSON(f, simplifyDataFrame = TRUE)
# test 1
tmp <- tempfile()
download(f, tmp, mode = "wb")
json <- fromJSON(tmp, simplifyDataFrame = TRUE)
fromJSON(content(GET(f), as = "text"), simplifyDataFrame = TRUE)
query <- GDCquery(project = cancer,
data.category = "Gene expression",
data.type = "miRNA gene quantification",
platform = PlatformCancer,
file.type  = dataType,
barcode = c(tumour,normal),
legacy = TRUE)
PlatformCancer <- "Illumina HiSeq"
query <- GDCquery(project = cancer,
data.category = "Gene expression",
data.type = "miRNA gene quantification",
platform = PlatformCancer,
file.type  = dataType,
barcode = c(tumour,normal),
legacy = TRUE)
data.type <- c("miRNA Expression Quantification")
data.type <- c("miRNA Expression Quantification")
for(i in data.type){
print(i)
query <- GDCquery(project = "TARGET-AML",
data.category = "Transcriptome Profiling",
data.type = i,
workflow.type = "BCGSC miRNA Profiling",
barcode = c("TARGET-20-PARUDL-03A-01R","TARGET-20-PASRRB-03A-01R"))
GDCdownload(query)
data <- GDCprepare(query)}
library(SpidermiR)
org<-SpidermiRquery_species(species)
net_type<-SpidermiRquery_networks_type(organismID=org[9,])
net_shar_prot<-SpidermiRquery_spec_networks(organismID = org[9,],
network = "SHpd")
disease<-SpidermiRquery_disease(diseaseID)
disease
setwd("C:/Users/663676/Desktop/StarTrek")
devtools::document()
devtools::document()
devtools::build(manual=TRUE)
devtools::check() # CREA MANUALE
setwd("C:/Users/663676/Desktop/StarTrek")
devtools::document()
devtools::build(manual=TRUE)
devtools::check() # CREA MANUALE
